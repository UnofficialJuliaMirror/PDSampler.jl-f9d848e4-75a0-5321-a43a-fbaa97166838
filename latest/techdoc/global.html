<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Global sampler · PDMP.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/highlightjs/default.css" rel="stylesheet" type="text/css"/><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><link href="../assets/partial.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>PDMP.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" action="../search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../index.html">Introduction</a></li><li><a class="toctext" href="../aboutpdmp.html">About PDMP</a></li><li><span class="toctext">Examples</span><ul><li><a class="toctext" href="../examples/ex_gbps1.html">Global BPS</a></li><li><a class="toctext" href="../examples/ex_lbps1.html">Local BPS</a></li></ul></li><li><span class="toctext">Technical Documentation</span><ul><li><a class="toctext" href="structure.html">Code structure</a></li><li><a class="toctext" href="coretools.html">Core tools</a></li><li><a class="toctext" href="models.html">Models</a></li><li class="current"><a class="toctext" href="global.html">Global sampler</a><ul class="internal"><li><a class="toctext" href="#Path-1">Path</a></li><li><a class="toctext" href="#Simulate-1">Simulate</a></li></ul></li><li><a class="toctext" href="local.html">Local sampler</a></li></ul></li><li><span class="toctext">Contributing</span><ul><li><a class="toctext" href="../contributing/addingexample.html">New example</a></li><li><a class="toctext" href="../contributing/addingfeature.html">New feature</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Technical Documentation</li><li><a href="global.html">Global sampler</a></li></ul><a class="edit-page" href="https://github.com/alan-turing-institute/PDMP.jl/tree/e49fab835c759c43ec10855a22982c467d96827b/docs/src/techdoc/global.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Global sampler</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="td-globalsampler-1" href="#td-globalsampler-1">Global sampler</a></h1><p>Link to the source files:</p><ul><li><p><a href="https://github.com/alan-turing-institute/PDMP.jl/blob/master/src/path.jl"><code>path.jl</code></a></p></li><li><p><a href="https://github.com/alan-turing-institute/PDMP.jl/blob/master/src/simulate.jl"><code>simulate.jl</code></a></p></li></ul><h2><a class="nav-anchor" id="Path-1" href="#Path-1">Path</a></h2><p>The <code>path.jl</code> file exports a type <code>Path</code> and a few functions that apply on such an object.</p><p>A <code>Path</code> object encapsulates</p><ul><li><p><code>xs</code> a matrix of size <span>$p \times N_e$</span> where <span>$p$</span> is the dimension and <span>$N_e$</span> are the number of events recorded</p></li><li><p><code>ts</code> a vectof of times associated with the events</p></li><li><p><code>p</code> the dimension</p></li><li><p><code>nseg</code> the number of segments</p></li></ul><h3><a class="nav-anchor" id="Auxiliary-type-1" href="#Auxiliary-type-1">Auxiliary type</a></h3><p>The type <code>Segment</code> is useful to encapsulate the information contained between two events. It contains:</p><ul><li><p><code>ta</code>, <code>tb</code> the times at the two events</p></li><li><p><code>xa</code>, <code>xb</code> the positions</p></li><li><p><code>tau</code> (implicit) the travel time corresponding to the segment or <span>$(t_b-t_a)$</span></p></li><li><p><code>v</code> (implicit) the velocity along the segment</p></li></ul><h3><a class="nav-anchor" id="Auxiliary-functions-1" href="#Auxiliary-functions-1">Auxiliary functions</a></h3><ul><li><p><code>getsegment</code> retrieves a segment starting at time <code>Path.ts[j]</code></p></li><li><p><code>samplepath</code> takes a time or a list of times and returns the position along the <code>Path</code> object at those times</p></li><li><p><code>quadpathpoly</code> does a simple analytical integration along the path for simple test functions of the form <span>$\varphi(x)=P(x)$</span> where <span>$P$</span> is a polynomial (for each dimension)</p></li><li><p><code>pathmean</code> computes the mean using <code>quadpathpoly</code> where the polynomial is just <span>$x$</span></p></li><li><p><code>esspath</code> computation of the ESS corresponding to a number of samples equally spaced along the path. It tries to achieve a specific ratio and increases the number of samples until it achieves it.</p></li></ul><h2><a class="nav-anchor" id="Simulate-1" href="#Simulate-1">Simulate</a></h2><p>The <code>simulate.jl</code> file is the main file for the Global Sampler. It contains one main immutable object which contains all of the parameters of the simulation. This is convenient if multiple parameters need to be tested.</p><p>A number of default parameters are pre-encoded but some parameters are essential (starting point, starting velocity, etc).</p><h3><a class="nav-anchor" id="Simulate-function-1" href="#Simulate-function-1">Simulate function</a></h3><p>This function should mimic rather closely the original paper. Note in the main loop:</p><pre><code class="language-julia">tau = min(bounce.tau, taubd, tauref)</code></pre><p>corresponds to finding which action needs to be executed (normal bounce, boundary bounce or refreshment). After this one of three branches is executed:</p><pre><code class="language-julia">if tau==bounce.tau
    ...
elseif tau==taubd
    ...
else
    ...
end</code></pre><p>The first branch corresponds to a bounce against the level set of the log-likelihood, the second to a boundary bounce and third a refreshment.</p><p>In the first branch, an explicit call to <code>bounce.dobounce</code> checks whether to thin the event or not. If the time is accepted then the velocity is refreshed otherwise the whole loop is ignored.</p><footer><hr/><a class="previous" href="models.html"><span class="direction">Previous</span><span class="title">Models</span></a><a class="next" href="local.html"><span class="direction">Next</span><span class="title">Local sampler</span></a></footer></article></body></html>
